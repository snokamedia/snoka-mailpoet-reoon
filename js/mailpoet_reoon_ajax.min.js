document.addEventListener("DOMContentLoaded",function(){function e(){r=l.test(i.value),r?(i.setAttribute("valid",""),i.removeAttribute("invalid")):(i.setAttribute("invalid",""),i.removeAttribute("valid")),d&&(s.style.display=r?"none":"block"),t()}function t(){o.disabled=!(r&&c)}var a,o=document.getElementById("mailpoet_reoon_submit"),n=document.getElementById("mailpoet_reoon_message"),s=(document.getElementById("mailpoet_reoon_form"),document.getElementById("snoka-email-invalid-msg")),c=!1,r=!1,i=document.getElementById("snoka-email-verify-input"),d=!1,l=/^[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z]{2,}$/;if(s.style.display="none",i.addEventListener("input",e),i.addEventListener("focusout",function(){d=!0,e()}),i.addEventListener("focus",function(){d&&!r&&(s.style.display="block")}),i.addEventListener("blur",function(){d&&!r&&(s.style.display="block")}),o.disabled=!0,mailpoet_reoon_ajax_object.recaptcha_site_key){var m=document.createElement("script");function p(){c=!0,t()}m.src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=explicit",m.async=!0,m.defer=!0,document.body.appendChild(m),window.onRecaptchaLoad=function(){a=grecaptcha.render("mailpoet_reoon_recaptcha",{sitekey:mailpoet_reoon_ajax_object.recaptcha_site_key,callback:p})}}o.addEventListener("click",function(e){e.preventDefault(),n.classList.add("processing-message"),n.innerHTML="Checking email";var t=document.getElementById("mailpoet_reoon_form"),o=new FormData(t),s=document.getElementById("mailpoet_reoon_form_nonce");if(s){var c=s.value;o.append("mailpoet_reoon_form_nonce",c)}t.style.display="none",o.append("g-recaptcha-response",document.getElementById("mailpoet_reoon_recaptcha").querySelector(".g-recaptcha-response").value),o.append("action","process_mailpoet_reoon_form"),fetch(mailpoet_reoon_ajax_object.ajax_url,{method:"POST",body:o}).then(e=>e.json()).then(e=>{e.success?(n.classList.remove("processing-message"),n.classList.add("success-message"),n.innerHTML=e.data.message):(n.classList.remove("processing-message"),n.classList.add("error-message"),n.innerHTML=e.data.message,"undefined"!=typeof grecaptcha&&void 0!==a&&grecaptcha.reset(a),t.style.display="block")}).catch(e=>{n.classList.remove("processing-message"),console.error("Error:",e),n.innerHTML="An error occurred: "+e.message,n.classList.add("error-message"),"undefined"!=typeof grecaptcha&&void 0!==a&&grecaptcha.reset(a),t.style.display="block"})})});